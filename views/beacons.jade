extends layout_admin

block scripts
  script(src="/javascripts/beacons.js")
  script(src='https://ajax.googleapis.com/ajax/libs/angularjs/1.3.11/angular.min.js')
  script(src='/javascripts/app.js')

  script(type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=weather,visualization,panoramio")
  script(src='//maps.google.com/maps/api/js')
  script(src='/javascripts/maps/ng-map.min.js')
block content
  .container-fluid(ng-controller="MapCtrl as map")
    ol.breadcrumb
      li
        a(href="/admin") Inicio
      li.active Beacons
    .row
      .col-xs-12.col-md-3
        .panel.panel-info
          .panel-heading
            h1 Registrar un Beacon
          .panel-body
            form(action="/admin/beacon/create", method="POST")
              .row
                .col-xs-8
                  .form-group
                    input.form-control(name="id_beacon", placeholder="ID Beacon")
                .col-xs-4
                  .form-group
                    input.form-control(id="cell" name="id_cell" placeholder="ID Celda" disabled)
                    input.hide.form-control(id="cell_hide" name="id_cell_hide")
              button.btn.btn-success(title="Registrar", type="submit") Registrar
          .panel-footer
            p Para a√±adir la celda es necesario seleccionarla en el mapa, no se puede modificar manualmente.
        .panel.panel-info
          .panel-heading
            h1 Beacons
          .panel-body.table-responsive
            table.table
              tbody
                tr
                  td ID Beacon
                  td ID Celda
                  td Acciones
                - each beacon in beacons
                  tr
                    td= beacon.id_beacon
                    td= beacon.id_cell
                    td.actions-group
                      button.btn.btn-info.left(title="Editar", onclick="$(\'#ed_#{beacon.id_beacon}\').toggle('fast')")
                        i.fa.fa-edit
                      form(action="/admin/beacon/delete", method="POST")
                        input.hide(name="id_beacon",value="#{beacon.id_beacon}")
                        button.btn.btn-danger(title="Eliminar", type="submit")
                          i.fa.fa-trash
                  tr.edit_beacon(id="ed_#{beacon.id_beacon}")
                    form(action="/admin/beacon/update", method="POST")
                      td
                        input.hide(name="id_beacon_old", value="#{beacon.id_beacon}")
                        input.form-control(name="id_beacon",placeholder="ID Beacon: #{beacon.id_beacon}")
                      td
                        input.form-control(name="id_cell",placeholder="ID Celda: #{beacon.id_cell}" disabled)
                      td.actions-group
                        button.btn.btn-success(title="Guardar", type="submit")
                          i.fa.fa-save
      .col-xs-12.col-md-9
        .panel.panel-info
          .panel-heading
            h1 Mapa
          .panel-body
            map(center="{{ map.location() }}",zoom="{{ map.airport.zoom }}")
              shape(
                id="cell_{{ map.airport.cells[0].cell }}"
                geodesic="{{ map.airport.cells_properties.geodesic }}"
                path="{{ map.airport.cells[0].path }}"
                name="{{ map.airport.cells_properties.name }}"
                stroke-color="{{ map.airport.cells_properties.stroke_color }}"
                clickable="{{ map.airport.cells_properties.clickable }}"
                on-click="click_cell()")
              shape(
                id="cell_{{ map.airport.cells[1].cell }}"
                geodesic="{{ map.airport.cells_properties.geodesic }}"
                path="{{ map.airport.cells[1].path }}"
                name="{{ map.airport.cells_properties.name }}"
                stroke-color="{{ map.airport.cells_properties.stroke_color }}"
                clickable="{{ map.airport.cells_properties.clickable }}"
                on-click="click_cell()")
              shape(
                id="cell_{{ map.airport.cells[2].cell }}"
                geodesic="{{ map.airport.cells_properties.geodesic }}"
                path="{{ map.airport.cells[2].path }}"
                name="{{ map.airport.cells_properties.name }}"
                stroke-color="{{ map.airport.cells_properties.stroke_color }}"
                clickable="{{ map.airport.cells_properties.clickable }}"
                on-click="click_cell()")
    